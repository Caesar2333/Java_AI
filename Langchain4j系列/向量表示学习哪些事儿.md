# å›¾åƒè¯†åˆ«çš„ä¸»æµç©æ³•ï¼ˆå‘é‡è¡¨ç¤ºå­¦ä¹ Embedding-based / è‡ªç›‘ç£ï¼‰

## ğŸ§  ä¸€å¥è¯è®²â€œå›¾åƒè¯†åˆ«â€çš„ä¸»æµç©æ³•ï¼š

> **å›¾åƒè¯†åˆ«ï¼ˆå°¤å…¶æ˜¯äººè„¸è¯†åˆ«ã€ä»¥å›¾æœå›¾ï¼‰æ ¸å¿ƒæ€è·¯å°±æ˜¯ï¼š**
>
> æŠŠå›¾åƒâ€œç¼–ç æˆå‘é‡â€ï¼Œæ”¾è¿›å‘é‡åº“ï¼Œä¹‹åå†æ¥ä¸€å¼ å›¾ï¼Œå°±æ‹¿è¿™ä¸ªå›¾çš„å‘é‡å»è·Ÿåº“é‡Œæ‰€æœ‰çš„å‘é‡**è®¡ç®—ç›¸ä¼¼åº¦**ï¼Œç„¶åè¿”å›æœ€ç›¸ä¼¼çš„å‡ ä¸ªã€‚

------

## ğŸ§± 1. å›¾åƒè¯†åˆ«çš„åº•å±‚æµç¨‹çœŸå°±è¿™å‡ æ­¥ï¼š

### ç¬¬ä¸€æ­¥ï¼šå›¾åƒ â†’ ç‰¹å¾å‘é‡

- ç”¨ CNNï¼ˆå·ç§¯ç¥ç»ç½‘ç»œï¼‰æˆ–è€…æ›´å¼ºçš„æ¨¡å‹ï¼ˆå¦‚ ResNetã€Vision Transformer ç­‰ï¼‰

- æŠŠä¸€å¼ å›¾ç‰‡å˜æˆä¸€ä¸ªå›ºå®šç»´åº¦çš„å‘é‡ï¼Œæ¯”å¦‚ `128ç»´`, `512ç»´`, `1024ç»´` ç­‰

- å‘é‡é•¿è¿™æ ·ï¼š

  ```
  [0.13, -0.56, 0.91, ..., 0.04]   â† ä¸€å¼ è„¸çš„â€œç‰¹å¾æŒ‡çº¹â€
  ```

### ç¬¬äºŒæ­¥ï¼šå­˜è¿›å‘é‡åº“ï¼ˆå‘é‡æ•°æ®åº“ï¼‰

- æŠŠæ‰€æœ‰å›¾ç‰‡çš„å‘é‡å…¨å­˜èµ·æ¥ï¼ˆç”¨ Faiss / Milvus / Pinecone / Elasticsearch ç­‰ï¼‰
- å­˜çš„ä¸æ˜¯å›¾ç‰‡ï¼Œè€Œæ˜¯è¿™äº›**ç¼–ç ä¹‹åçš„å‘é‡** + å…³è”çš„ä¿¡æ¯ï¼ˆæ¯”å¦‚æ˜¯è°ï¼‰

### ç¬¬ä¸‰æ­¥ï¼šæœç´¢é˜¶æ®µä¹Ÿåšå‘é‡æå– â†’ ç›¸ä¼¼åº¦æ¯”è¾ƒ

- æ–°å›¾ç‰‡ä¹Ÿæå–æˆä¸€ä¸ªå‘é‡
- å’Œåº“é‡Œæ‰€æœ‰å‘é‡åšç›¸ä¼¼åº¦æ¯”è¾ƒï¼ˆä¸€èˆ¬ç”¨ **ä½™å¼¦ç›¸ä¼¼åº¦** æˆ–è€… **L2 è·ç¦»**ï¼‰
- æ’ä¸ªåºï¼Œæ‰¾å‡ºâ€œæœ€åƒçš„å‡ ä¸ªâ€

------

## ğŸ” 2. æ‰€ä»¥ä½ è¯´çš„â€œå­˜è¿›æ•°æ®å‘é‡åº“ + æ¯”ç›¸ä¼¼åº¦â€æœ¬è´¨ä¸Šæ²¡é”™ï¼

å›¾åƒè¯†åˆ« = ç‰¹å¾æå– + å‘é‡æ¯”å¯¹ + ç»“æœæ˜ å°„
 å®Œå…¨å¯ä»¥æŠ½è±¡æˆä¸‹é¢è¿™ä¸ªç»å…¸å¥—è·¯ï¼š

```
å›¾åƒï¼ˆå›¾ç‰‡.jpgï¼‰â†’ ç‰¹å¾æå–å™¨ï¼ˆæ¨¡å‹ï¼‰â†’ å‘é‡ï¼ˆ[0.1, 0.2, ..., 0.8]ï¼‰
                                         â†“
                           å‘é‡æ•°æ®åº“ä¸­æ¯”ç›¸ä¼¼åº¦ â†’ è¿”å›ç»“æœï¼ˆæ¯”å¦‚åå­—ã€äººè„¸ã€ç‰©ä½“åï¼‰
```

------

## ğŸš« è·Ÿä¼ ç»Ÿåˆ†ç±»æ¨¡å‹æœ‰å•¥åŒºåˆ«ï¼Ÿ

| ç±»å‹     | åŸç†                                             | å±€é™                                       | åœºæ™¯                           |
| -------- | ------------------------------------------------ | ------------------------------------------ | ------------------------------ |
| åˆ†ç±»æ¨¡å‹ | å›¾åƒè¾“å…¥åç›´æ¥è¾“å‡ºåˆ†ç±»æ ‡ç­¾ï¼ˆå¦‚â€œç‹—â€ã€â€œçŒ«â€ã€â€œè½¦â€ï¼‰ | åªèƒ½è¯†åˆ«ä½ è®­ç»ƒè¿‡çš„ç±»åˆ«                     | å°å‹å›¾åƒåˆ†ç±»                   |
| æ£€ç´¢æ¨¡å‹ | å›¾åƒè¾“å…¥åå˜æˆå‘é‡ â†’ æ‹¿å‘é‡å»æ¯”                  | èƒ½è¯†åˆ«ä½ **æ²¡è®­ç»ƒè¿‡çš„**å›¾åƒï¼ˆåªè¦å»ºäº†ç´¢å¼•ï¼‰ | ä»¥å›¾æœå›¾ã€äººè„¸è¯†åˆ«ã€æ¨èç³»ç»Ÿç­‰ |

* #### è¿™å°±æ˜¯ä¸ºå•¥ä½ çœ‹**äººè„¸è¯†åˆ«**ï¼Œä¸æä»€ä¹ˆâ€œåˆ†ç±»æ¨¡å‹â€ï¼Œéƒ½ç”¨â€œæ¯”ç›¸ä¼¼åº¦â€çš„æ–¹å¼ï¼

* #### å’Œä¼ ç»Ÿçš„åˆ†ç±»æ¨¡å‹æ ¹æœ¬ä¸ä¸€æ ·ã€‚

## ğŸ§  æœ€åä¸€ä¸ªè¡¥åˆ€ï¼šä¸ºå•¥â€œå‘é‡â€èƒ½æ¯”å‡ºç›¸ä¼¼åº¦ï¼Ÿ

å› ä¸ºç»è¿‡æ·±åº¦å­¦ä¹ æ¨¡å‹ä¹‹åï¼Œå®ƒèƒ½æŠŠ**ç›¸ä¼¼çš„å›¾ç‰‡**è½¬åŒ–ä¸º**ç›¸ä¼¼çš„å‘é‡**ï¼

æ¯”å¦‚ï¼š

- å¼ ä¸‰è„¸çš„å‘é‡ï¼š[0.1, 0.2, 0.5, ...]
- å¼ ä¸‰çš„å¦ä¸€å¼ è„¸ï¼š[0.09, 0.21, 0.49, ...] â†’ è·ç¦»å¾ˆè¿‘
- æå››çš„è„¸ï¼š[0.77, -0.34, 0.8, ...] â†’ è·ç¦»å¾ˆè¿œ

**è·ç¦»å° = åƒï¼Œè·ç¦»å¤§ = ä¸åƒ**ï¼Œå°±è¿™ä¹ˆå›äº‹ã€‚







# å›¾åƒè¯†åˆ«ä¸Šè¿°çš„é‚£ä¸€ä¸ªç¯èŠ‚æ˜¯çµé­‚ï¼Ÿ

## âœ… é—®é¢˜ï¼ˆ1ï¼‰ï¼šå›¾åƒè¯†åˆ«é‡Œæœ€å…³é”®çš„æ˜¯ **å‘é‡æ•°æ®åº“** è¿˜æ˜¯ **å›¾åƒè½¬å‘é‡æ¨¡å‹**ï¼Ÿ

### ğŸ§  ç­”æ¡ˆæ˜¯ï¼š**å›¾åƒè½¬å‘é‡çš„ç®—æ³•æ¨¡å‹** æ˜¯æ•´ä¸ªç³»ç»Ÿçš„çµé­‚

ä¹Ÿå°±æ˜¯æ‰€è°“çš„ï¼š**embedding æ¨¡å‹**ï¼ˆç‰¹å¾æå–å™¨ï¼‰

> å‘é‡åº“æ˜¯â€œé«˜é€ŸæŸ¥æ‰¾å™¨â€ï¼›æ¨¡å‹æ˜¯â€œå‘é‡ç”Ÿæˆå™¨â€ï¼›
>  çœŸæ­£å†³å®šä½ èƒ½ä¸èƒ½è¯†åˆ«äººè„¸ã€èƒ½ä¸èƒ½æ‰¾å¯¹å›¾ï¼Œæ˜¯â€œå‘é‡é•¿å¾—å¥½ä¸å¥½â€ï¼Œä¹Ÿå°±æ˜¯æ¨¡å‹æœ¬èº«ç‰›ä¸ç‰›é€¼ï¼

------

### ğŸ¯ ä¸ºä»€ä¹ˆè¿™ä¹ˆè¯´ï¼Ÿ

å‡è®¾ä½ ï¼š

- æŠŠå›¾ç‰‡Aè½¬æ¢å‡ºæ¥çš„å‘é‡æ˜¯ `[0.1, 0.2, 0.3, ...]`ï¼›
- æŠŠå›¾ç‰‡Bä¹Ÿè½¬æ¢æˆ `[0.11, 0.19, 0.29, ...]`ï¼›
- é‚£ä½ å°±çŸ¥é“Aå’ŒBæ˜¯åƒçš„ã€‚

ä½†ï¼å¦‚æœä½ æ¨¡å‹çƒ‚ï¼Œæå–å‡ºæ¥å‘é‡æ¯«æ— è§„å¾‹ï¼Œæ¯”å¦‚ï¼š

- åŒä¸€ä¸ªäººè„¸ç”Ÿæˆå‡ºæ¥ä¸¤ä¸ªä¹±ä¸ƒå…«ç³Ÿå‘é‡ `[0.33, -0.87, 0.2, ...]` vs `[0.71, 0.62, 0.99, ...]`
- é‚£ä½ æ¯”å¯¹ä¸ªé¸¡æ¯›å•Šï¼Ÿï¼

## âœ… é—®é¢˜ï¼ˆ2ï¼‰ï¼šFaiss / Milvus æ˜¯å•¥ï¼Ÿ CNN / ResNet æ˜¯å•¥ï¼Ÿæ€ä¹ˆåˆ†ç±»ï¼Ÿ

æˆ‘ä»¬æŠŠä½ è¯´çš„è¿™äº›å·¥å…·/ç®—æ³•åˆ†ä¸¤å¤§ç±»æ¥çœ‹ï¼š

| ç±»å‹             | ä¸¾ä¾‹                                  | ä½œç”¨                           | è°çš„äº‹æƒ…ï¼Ÿ       |
| ---------------- | ------------------------------------- | ------------------------------ | ---------------- |
| ğŸ§  ç‰¹å¾æå–æ¨¡å‹   | CNNã€ResNetã€ViTã€MobileNetã€CLIP     | æŠŠå›¾åƒè½¬æˆå‘é‡ï¼ˆEmbeddingï¼‰    | æ·±åº¦å­¦ä¹ æ¨¡å‹å¹²çš„ |
| ğŸš€ å‘é‡æ•°æ®åº“å¼•æ“ | Faissã€Milvusã€Pineconeã€ESã€Weaviate | ä½ æœ‰äº†å‘é‡ä¹‹åï¼Œæ€ä¹ˆé«˜æ•ˆæœç´¢ï¼Ÿ | æ£€ç´¢ç³»ç»Ÿå¹²çš„     |

### âœ… ç‰¹å¾æå–å™¨ï¼ˆCNN / ResNet / ViTï¼‰ï¼š

- æœ¬è´¨å°±æ˜¯ç¥ç»ç½‘ç»œæ¨¡å‹
- è¾“å…¥å›¾ç‰‡ â†’ è¾“å‡ºä¸€ä¸ªé«˜ç»´å‘é‡
- å¯ä»¥è‡ªè®­ç»ƒã€å¾®è°ƒï¼Œæˆ–è€…ç›´æ¥ç”¨åˆ«äººè®­å¥½çš„æ¨¡å‹

### âœ… å‘é‡æ•°æ®åº“ï¼ˆFaiss / Milvus ç­‰ï¼‰ï¼š

- ä¸“é—¨ä¼˜åŒ–è¿‡çš„â€œç›¸ä¼¼å‘é‡æ£€ç´¢ç³»ç»Ÿâ€
- æ”¯æŒç™¾ä¸‡ã€åƒä¸‡çº§åˆ«å‘é‡çš„å¿«é€Ÿæœç´¢
- å†…ç½®å¾ˆå¤šåŠ é€Ÿç®—æ³•ï¼Œæ¯”å¦‚ï¼š
  - HNSWï¼ˆå±‚æ¬¡å›¾æœç´¢ï¼‰
  - IVFï¼ˆå€’æ’æ–‡ä»¶åˆ†æ¡¶ï¼‰
  - PQï¼ˆå‹ç¼©é‡åŒ–ï¼‰

## âœ… é—®é¢˜ï¼ˆ3ï¼‰ï¼šç›¸ä¼¼åº¦æ¯”è¾ƒæ–¹æ³•é™¤äº†ä½™å¼¦ç›¸ä¼¼åº¦è¿˜æœ‰å•¥ï¼Ÿ

**æ²¡é”™ï¼ç¡®å®æœ‰å¾ˆå¤šç§ï¼Œé€‰æ‹©ä¹Ÿæœ‰è®²ç©¶ã€‚**

### å¸¸è§çš„å‘é‡ç›¸ä¼¼åº¦åº¦é‡æ–¹æ³•ï¼š

| æ–¹æ³•                   | æ•°å­¦å½¢å¼             | ç‰¹ç‚¹                   | é€‚ç”¨æƒ…å†µ   |
| ---------------------- | -------------------- | ---------------------- | ---------- |
| ğŸ§® ä½™å¼¦ç›¸ä¼¼åº¦ï¼ˆcosineï¼‰ | `cos(Î¸) = AÂ·B / (    |                        | A          |
| ğŸ“ æ¬§å‡ é‡Œå¾—è·ç¦»ï¼ˆL2ï¼‰   | `                    |                        | A - B      |
| ğŸš¶ æ›¼å“ˆé¡¿è·ç¦»ï¼ˆL1ï¼‰     | `                    | a1 - b1                | +          |
| ğŸ§Š æ±‰æ˜è·ç¦»             | äºŒå€¼å‘é‡ä¹‹é—´ç›¸å¼‚ä½æ•° | ç”¨äºå‹ç¼©åçš„äºŒè¿›åˆ¶å‘é‡ | é‡åŒ–åæ£€ç´¢ |

### ğŸ”§ å‘é‡æ•°æ®åº“ä¸€èˆ¬æ”¯æŒçš„ï¼š

| å‘é‡åº“                            | æ”¯æŒçš„è·ç¦»ç±»å‹                                |
| --------------------------------- | --------------------------------------------- |
| **Faiss**                         | L2ã€Cosineï¼ˆé—´æ¥å®ç°ï¼‰ã€Inner Productï¼ˆç‚¹ç§¯ï¼‰ |
| **Milvus**                        | L2ã€IPã€Cosineã€Jaccardã€Tanimoto ç­‰          |
| **Pinecone**                      | Cosineã€Dotã€Euclidean                        |
| **Elasticsearchï¼ˆDense Vectorï¼‰** | Cosineã€L2ï¼ˆç¨€çƒ‚ï¼Œæ…¢ï¼‰                        |

## ğŸ“Œ è¡¥å……å»ºè®®ï¼šæ€ä¹ˆé€‰è·ç¦»å‡½æ•°ï¼Ÿ

- **ä½ çš„å‘é‡æœ‰æ²¡æœ‰å½’ä¸€åŒ–ï¼Ÿ**
  - å½’ä¸€åŒ–äº† â†’ ç”¨ä½™å¼¦ã€ç‚¹ç§¯
  - æ²¡å½’ä¸€åŒ– â†’ ç”¨æ¬§å‡ é‡Œå¾—ï¼ˆL2ï¼‰
- **ä½ åœ¨ä¹æ–¹å‘è¿˜æ˜¯ç»å¯¹è·ç¦»ï¼Ÿ**
  - æ–¹å‘ï¼ˆç›¸ä¼¼è¶‹åŠ¿ï¼‰â†’ ä½™å¼¦
  - è·ç¦»ï¼ˆå…·ä½“å·®å€¼ï¼‰â†’ L2

## ğŸ“Œ æ€»ç»“ä½ è¿™ä¸‰ä¸ªé—®é¢˜æ ¸å¿ƒè§‚ç‚¹

| é—®é¢˜           | æ ¸å¿ƒè§‚ç‚¹                                                     |
| -------------- | ------------------------------------------------------------ |
| æœ€é‡è¦æ˜¯è°ï¼Ÿ   | æ¨¡å‹æœ€é‡è¦ï¼Œå› ä¸ºå®ƒå®šä¹‰äº†â€œå‘é‡è´¨é‡â€ï¼Œæ¯”å¾—å†å¿«ä¹Ÿæ²¡ç”¨ï¼Œå‘é‡é”™äº†ç™½æ­ |
| è¿™äº›å·¥å…·æ˜¯å•¥ï¼Ÿ | æ¨¡å‹æ˜¯â€œå‘é‡åˆ¶é€ å·¥å‚â€ï¼Œå‘é‡åº“æ˜¯â€œå‘é‡æ£€ç´¢å·¥å…·â€                 |
| ç›¸ä¼¼åº¦è¿˜æœ‰å•¥ï¼Ÿ | æ˜¯çš„ï¼ä½™å¼¦ã€L2ã€IP éƒ½èƒ½ç”¨ï¼Œä¸åŒåº“æ”¯æŒä¸åŒè·ç¦»                |



# å‘é‡è¡¨ç¤ºå­¦ä¹ ä¸ºä»€ä¹ˆé‚£ä¹ˆæµè¡Œï¼Ÿ

## âœ… ç¬¬ä¸€é—®ï¼š**ç°åœ¨å‘é‡è¡¨ç¤ºå­¦ä¹ çœŸçš„å¾ˆæµè¡Œå—ï¼Ÿæ˜¯ä¸æ˜¯æ¯”ç›‘ç£å­¦ä¹ è¿˜è¦ä¸»æµï¼Ÿ**

### ğŸ’£ ç­”æ¡ˆæ˜¯ï¼š**åœ¨å¤§å¤šæ•°ç°ä»£ä»»åŠ¡ä¸­ï¼Œå‘é‡è¡¨ç¤ºå­¦ä¹ ï¼ˆEmbedding-based / è‡ªç›‘ç£ï¼‰\**ç¡®å®å·²ç»æˆäº†\**ä¸»æµæ–¹å‘**ï¼Œå¹¶ä¸”**é€æ¸å–ä»£çº¯ç›‘ç£å­¦ä¹ åœ¨å¾ˆå¤šä»»åŠ¡ä¸Šçš„æ ¸å¿ƒåœ°ä½ã€‚**

* ####  åˆ†ç±»æ¨¡å‹å°±åƒå°å­¦æ•°å­¦ï¼Œåªæœ‰å½“ä½ ç›®æ ‡ç‰¹åˆ«æ¸…æ¥šçš„æ—¶å€™æ‰ç”¨ã€‚å…¶ä½™æ—¶å€™ï¼š**å­¦å‘é‡**ï¼Œ**é æ¯”å¯¹**ï¼Œ**ä¸€æŠŠæ¢­**ã€‚

* #### ç°åœ¨å…¬å¸åšæ¨èã€æœç´¢ã€ç†è§£ã€ç”Ÿæˆã€ç†è§£ç”¨æˆ·è¡Œä¸ºâ€¦â€¦**å‡ ä¹å…¨éƒ¨éƒ½é  Embedding/å‘é‡ è¡¨ç¤ºæå®šçš„**ã€‚

------

### ğŸ§­ ä¸ºä»€ä¹ˆè¶Šæ¥è¶Šå¤šäººç”¨ã€Œå‘é‡ã€è€Œä¸æ˜¯ã€Œåˆ†ç±»æ ‡ç­¾ã€ï¼Ÿ

#### âœ… 1. **â€œä¸–ç•Œå¤ªå¤æ‚â€äº†ï¼Œæ ‡ç­¾æ ¹æœ¬ä¸å¤Ÿç”¨**

- ç›‘ç£å­¦ä¹ å¿…é¡»æœ‰æ˜ç¡®æ ‡ç­¾ï¼Œæ¯”å¦‚çŒ«/ç‹—/äºº/é©¬
- ä½†çœŸå®ä¸–ç•Œä¸­æ•°æ®å¤ªå¤šï¼Œæ ‡ç­¾å¤ªå°‘ï¼Œç”šè‡³ä¸å¯èƒ½æ‰“å®Œæ•´æ ‡ç­¾
- ä½ æ€»ä¸èƒ½ç»™æ¯å¼ å›¾éƒ½æ‰“ä¸Šâ€œå¤©ä¸Šé‚£æœµäº‘é•¿å¾—åƒå•¥â€çš„æ ‡ç­¾å§ï¼Ÿ

â¡ï¸ **å‘é‡å­¦ä¹ çš„ä¼˜åŠ¿æ˜¯ï¼šä¸éœ€è¦å®Œæ•´æ ‡ç­¾ï¼Œå®ƒå­¦çš„æ˜¯ã€Œç›¸ä¼¼æ€§ã€ï¼Œæ›´åƒäººç±»çš„ç›´è§‰ã€‚**

------

#### âœ… 2. **å‘é‡è¡¨ç¤ºæ›´â€œæ³›ç”¨â€ï¼Œèƒ½å¹²çš„æ´»å„¿æ›´å¤š**

- åˆ†ç±»æ¨¡å‹åªèƒ½åšåˆ†ç±»
- å‘é‡æ¨¡å‹å¯ä»¥å¹²å¾ˆå¤šäº‹ï¼š
  - ç›¸ä¼¼å›¾æœç´¢ï¼ˆå›¾æœå›¾ï¼‰
  - å‘é‡æ¨èç³»ç»Ÿï¼ˆæ¯”å¦‚ä½ å¬çš„æ­Œåƒ XXï¼‰
  - èšç±»ã€é™ç»´ã€å¯è§†åŒ–
  - å¤šæ¨¡æ€å¯¹é½ï¼ˆå›¾æ–‡ã€å›¾éŸ³ã€è§†é¢‘ï¼‰

â¡ï¸ è¿™å°±åƒï¼šä½ é€ äº†ä¸€æŠŠåˆ€ï¼Œå¯ä»¥åˆ‡å¾ˆå¤šèœï¼Œè€Œä¸æ˜¯åªèƒ½åˆ‡é»„ç“œã€‚

------

#### âœ… 3. **é¢„è®­ç»ƒ + å¾®è°ƒ = æ¯”ç›‘ç£å­¦ä¹ æ›´ç‰›é€¼**

- è‡ªç›‘ç£ / è¡¨å¾å­¦ä¹ ï¼ˆå¦‚ BERTã€CLIPã€DINOã€SimCLRï¼‰åªé åŸå§‹æ•°æ®å°±èƒ½è®­ç»ƒå‡ºé€šç”¨æ¨¡å‹
- åé¢å¯ä»¥æ ¹æ®ä½ çš„å°ä»»åŠ¡ï¼Œå¾®è°ƒä¸€ä¸‹å‘é‡å°±èƒ½è¾¾åˆ°æ¯”ç›‘ç£æ¨¡å‹æ›´å¥½çš„æ•ˆæœ

â¡ï¸ ç±»ä¼¼äº GPTï¼šå…ˆè®©å¤§æ¨¡å‹ç†è§£â€œè¿™ä¸ªä¸–ç•Œâ€ï¼Œå†å»åšåˆ†ç±»/ç”Ÿæˆä»»åŠ¡

------

#### âœ… 4. **å¤§æ¨¡å‹çš„å´›èµ·ï¼Œæœ¬è´¨å°±æ˜¯ Embedding ä¸‡èƒ½åŒ–**

- GPT/LLM æ ¸å¿ƒè¾“å‡ºå°±æ˜¯ï¼šæ¯ä¸ª token çš„å‘é‡
- CLIP/BLIP æ ¸å¿ƒè¾“å‡ºï¼šæ¯å¼ å›¾çš„è¯­ä¹‰å‘é‡
- Retrieval-Augmented Generationï¼ˆRAGï¼‰é çš„æ˜¯ã€Œå‘é‡å¬å›æ–‡æ¡£ã€

æ‰€ä»¥è¯´åˆ°åº•ï¼Œä½ çœ‹åˆ°çš„å¾ˆå¤šâ€œå¤§æ¨¡å‹å¼ºå¤§â€æœ¬è´¨æ˜¯ã€Œå®ƒå­¦ä¼šäº†æ€ä¹ˆæŠŠä¸–ç•Œå‹ç¼©æˆå‘é‡ç©ºé—´ã€ã€‚

------

## ğŸš©æ€»ç»“ä¸€å¥è¯ï¼š

> â€œç”¨å‘é‡è¡¨ç¤ºä¸€åˆ‡â€ï¼Œå·²ç»æˆäº†ç°ä»£æ·±åº¦å­¦ä¹ çš„ä¸»æµæ½®æµï¼Œè€Œä¸ä»…ä»…æ˜¯ä¸€ä¸ªå°ä¼—æŠ€æœ¯ã€‚

------

## âœ… ç¬¬äºŒé—®ï¼šè®­ç»ƒçš„æ—¶å€™åˆ°åº•è¦ä¸è¦å‘Šè¯‰æ¨¡å‹â€œè¿™ä¸ªä¸œè¥¿æ˜¯ä»€ä¹ˆâ€ï¼Ÿ

### ä½ é—®çš„å…¶å®æ˜¯ï¼š

> å‘é‡æ¨¡å‹è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œéœ€è¦æ˜ç¡®å‘Šè¯‰æ¨¡å‹ï¼šâ€œè¿™æ˜¯çŒ«â€ã€â€œè¿™æ˜¯ç‹—â€å—ï¼Ÿè¿˜æ˜¯åªéœ€è¦è®©å®ƒçŸ¥é“â€œè¿™äº›å›¾æ˜¯ä¸€æ ·çš„ï¼Œé‚£äº›å›¾ä¸ä¸€æ ·â€ï¼Ÿ

ç­”æ¡ˆæ˜¯ï¼š**è¦åˆ†æƒ…å†µè®¨è®ºï¼Œåˆ†ä¸ºä¸‰ç§ä¸»æµè®­ç»ƒç­–ç•¥**ğŸ‘‡

## ğŸ§ª ä¸€ã€ä¼ ç»Ÿç›‘ç£å­¦ä¹ ï¼ˆéœ€è¦æ ‡ç­¾ï¼Œæ˜ç¡®å‘Šè¯‰æ¨¡å‹â€œè¿™æ˜¯ä»€ä¹ˆâ€ï¼‰

- ç”¨äºåˆ†ç±»æ¨¡å‹ï¼ˆCNN + Softmaxï¼‰

- è®­ç»ƒæ—¶å–‚ï¼š

  ```
  textå¤åˆ¶ç¼–è¾‘è¾“å…¥ï¼šå›¾ç‰‡
  è¾“å‡ºï¼šç±»åˆ«æ ‡ç­¾ï¼ˆæ¯”å¦‚â€œçŒ«â€ï¼‰
  ```

- æ¨¡å‹å­¦çš„æ˜¯ï¼šâ€œä¸åŒç±»åˆ«ä¹‹é—´çš„è¾¹ç•Œæ€ä¹ˆç”»æ¸…æ¥šâ€

## ğŸ§ª äºŒã€å¯¹æ¯”å­¦ä¹ ï¼ˆcontrastive learningï¼‰âœ”ï¸ç°ä»£ä¸»æµ

- ä¸å‘Šè¯‰æ¨¡å‹å…·ä½“æ˜¯ä»€ä¹ˆï¼Œåªå‘Šè¯‰â€œè¿™äº›æ˜¯ç›¸ä¼¼çš„â€ã€â€œè¿™äº›ä¸ç›¸ä¼¼â€

- ç”¨å›¾å¯¹/æ–‡æœ¬å¯¹è®­ç»ƒï¼š

  ```
  textå¤åˆ¶ç¼–è¾‘å›¾ç‰‡A + å›¾ç‰‡Bï¼šæ˜¯åŒç±»ï¼ˆè·ç¦»è¿‘ï¼‰
  å›¾ç‰‡A + å›¾ç‰‡Cï¼šä¸æ˜¯åŒç±»ï¼ˆè·ç¦»è¿œï¼‰
  ```

- æ¨¡å‹å­¦çš„æ˜¯ï¼šâ€œè¯­ä¹‰ç©ºé—´é‡Œè°åº”è¯¥é è¿‘è°â€

ğŸ“Œä»£è¡¨æ¨¡å‹ï¼š

- SimCLR
- MoCo
- BYOL
- DINOï¼ˆè§†è§‰ï¼‰
- CLIPï¼ˆå›¾æ–‡ï¼‰

## ğŸ§ª ä¸‰ã€è‡ªç›‘ç£é¢„è®­ç»ƒï¼ˆå®Œå…¨ä¸éœ€è¦äººå·¥æ ‡ç­¾ï¼‰

- æ¯”å¦‚ï¼š
  - ä¸€ä¸ªå¥å­é®æ‰ä¸€ä¸ªè¯ï¼Œé¢„æµ‹è¢«é®çš„è¯ï¼ˆBERTï¼‰
  - æŠŠå›¾åƒåˆ†å—é®ä½ä¸€éƒ¨åˆ†ï¼Œé¢„æµ‹é‚£å—æ˜¯ä»€ä¹ˆï¼ˆMAEï¼‰
  - æŠŠä¸€ä¸ªå›¾è£å‰ªæˆä¸¤ä»½ï¼Œå­¦ä¼šâ€œå®ƒä»¬æ˜¯åŒä¸€ä¸ªä¸œè¥¿â€

è¿™ç§æ–¹å¼å®Œå…¨ä¸ä¾èµ–æ ‡ç­¾ï¼Œè€Œæ˜¯é ä»»åŠ¡æœ¬èº«æŒ–æ˜â€œç›‘ç£ä¿¡å·â€ã€‚

------

## ğŸ¯ æ€»ç»“ï¼šä½ è¯¥æ€ä¹ˆè®°è¿™ä¸ªå…³ç³»ï¼Ÿ

| ç±»å‹       | æ˜¯å¦éœ€è¦å‘Šè¯‰â€œè¿™æ˜¯ä»€ä¹ˆâ€ï¼Ÿ         | æ˜¯å¦ç”Ÿæˆå‘é‡ï¼Ÿ   | ä¸¾ä¾‹            |
| ---------- | -------------------------------- | ---------------- | --------------- |
| ç›‘ç£å­¦ä¹    | âœ… éœ€è¦æ˜ç¡®æ ‡ç­¾                   | âŒ ä¸ä¸€å®šè¾“å‡ºå‘é‡ | CNNåˆ†ç±»æ¨¡å‹     |
| å¯¹æ¯”å­¦ä¹    | âŒ ä¸å‘Šè¯‰åå­—ï¼Œåªå‘Šè¯‰â€œè¿‘/è¿œâ€      | âœ… è¾“å‡ºå‘é‡       | CLIPã€SimCLR    |
| è‡ªç›‘ç£å­¦ä¹  | âŒ ä¸å‘Šè¯‰ä»»ä½•ä¸œè¥¿ï¼Œå…¨é æ•°æ®è‡ªå·±ç© | âœ… è¾“å‡ºå‘é‡       | BERTã€MAEã€DINO |

------

## âœ… è¡¥ä¸€å¥å¾ˆç°å®çš„è¯ï¼š

* #### ç°åœ¨å…¬å¸åšæ¨èã€æœç´¢ã€ç†è§£ã€ç”Ÿæˆã€ç†è§£ç”¨æˆ·è¡Œä¸ºâ€¦â€¦**å‡ ä¹å…¨éƒ¨éƒ½é  Embedding/å‘é‡ è¡¨ç¤ºæå®šçš„**ã€‚

* ####  åˆ†ç±»æ¨¡å‹å°±åƒå°å­¦æ•°å­¦ï¼Œåªæœ‰å½“ä½ ç›®æ ‡ç‰¹åˆ«æ¸…æ¥šçš„æ—¶å€™æ‰ç”¨ã€‚å…¶ä½™æ—¶å€™ï¼š**å­¦å‘é‡**ï¼Œ**é æ¯”å¯¹**ï¼Œ**ä¸€æŠŠæ¢­**ã€‚

  

# Langchain4jä¸­RAGçš„æ–¹æ¡ˆ

> ğŸ§  **LangChain4j ä¸­æ–‡æœ¬è¯­ä¹‰æœç´¢ç³»ç»Ÿæ ¸å¿ƒç»„ä»¶ä¸‰ä»¶å¥—ï¼š**
>
> âœ… åˆ†è¯å™¨ï¼ˆText Splitterï¼‰
>  âœ… åµŒå…¥æ¨¡å‹ï¼ˆEmbedding Modelï¼‰
>  âœ… å‘é‡æ•°æ®åº“ï¼ˆVector Storeï¼‰

ä½ é—®çš„å°±æ˜¯ï¼šâ€œè¿™ä¸‰æ ·ï¼Œå®é™…ç”¨èµ·æ¥å“ªå¥—æœ€ç¨³ã€æœ€é€šç”¨ã€æœ€çœé’±ï¼Ÿâ€

æˆ‘æ¥å¸®ä½ ç›´æ¥ç†å‡ºä¸€å¥—ä¸šç•Œæ¨èç»„åˆï¼ˆå®æˆ˜æ´¾ï¼Œä¸ç„å­¦ï¼‰ğŸ‘‡

## ğŸ§© 1. åˆ†è¯å™¨ï¼ˆTextSplitterï¼‰â€”â€”â€œæ€ä¹ˆæŠŠå¤§æ®µæ–‡æœ¬åˆ‡ç¢æˆåˆé€‚ç²’åº¦çš„ chunkï¼Ÿâ€

LangChain4j æä¾›äº†å¤šç§æ–‡æœ¬åˆ†å—å™¨ï¼Œé€‚åˆä¸­æ–‡æˆ–è‹±æ–‡éƒ½æœ‰å·®å¼‚åŒ–ã€‚

### âœ… æ¨èæ–¹æ¡ˆï¼š

| åˆ†è¯å™¨ç±»                   | ç‰¹ç‚¹                                       | æ˜¯å¦é€‚åˆä¸­æ–‡ï¼Ÿ | å®æˆ˜å»ºè®®         |
| -------------------------- | ------------------------------------------ | -------------- | ---------------- |
| `RecursiveTextSplitter`    | é»˜è®¤åˆ†å—å™¨ï¼Œæ”¯æŒå¤šçº§åˆ†éš”ç¬¦ï¼ˆæ®µ â†’ å¥ â†’ è¯ï¼‰ | âœ… æ”¯æŒ         | æ¨èä¸»åŠ›         |
| `CharacterTextSplitter`    | æŒ‰å­—ç¬¦å®šé•¿åˆ‡                               | âœ… ä¸­æ–‡ä¹Ÿé€‚ç”¨   | ç®€å•ç²—æš´å‹       |
| `DocumentSplitters` å·¥å…·ç±» | æä¾›å·¥å‚æ–¹æ³•                               | âœ…              | é€šå¸¸é…åˆé»˜è®¤ use |



```java
TextSplitter splitter = RecursiveTextSplitter.builder()
    .chunkSize(500)
    .chunkOverlap(50)
    .build();
```

- `chunkSize` å»ºè®®è®¾ä¸º 256 ~ 512 tokenï¼ˆå®é™…æŒ‰å­—ç¬¦è®¡ä¹Ÿè¡Œï¼‰
- `chunkOverlap` åŠ ä¸€ç‚¹é‡å èƒ½ä¿ç•™ä¸Šä¸‹æ–‡

> âš ï¸ ä¸­æ–‡ç¯å¢ƒä¸è¦ç”¨åŸºäºç©ºæ ¼çš„åˆ†è¯å™¨ï¼ˆåƒ OpenAiTextSplitterï¼‰ï¼Œå¦åˆ™ä¼šæŠŠä¸€ä¸ªæˆè¯­åˆ‡ä¸€åŠã€‚

## ğŸ§  2. åµŒå…¥æ¨¡å‹ï¼ˆEmbeddingModelï¼‰â€”â€”â€œæ€ä¹ˆæŠŠ chunk å˜æˆè¯­ä¹‰å‘é‡ï¼Ÿâ€

LangChain4j æ”¯æŒå¾ˆå¤šç§åµŒå…¥æ¨¡å‹ï¼Œä¸ç®¡ä½ æ˜¯æœ¬åœ°ã€OpenAIã€Ollamaã€è¿˜æ˜¯ HuggingFace éƒ½èƒ½æã€‚

### âœ… æ¨èç»„åˆï¼š

| åœºæ™¯                 | åµŒå…¥æ¨¡å‹å®ç°                            | ä¼˜åŠ¿                         | æ˜¯å¦å…è´¹æœ¬åœ°å¯éƒ¨ç½² |
| -------------------- | --------------------------------------- | ---------------------------- | ------------------ |
| è‹±æ–‡ä»»åŠ¡ + çœäº‹      | `OpenAiEmbeddingModel`                  | ç®€å•å¼ºå¤§ï¼Œé€‚é… GPT ç³»ç»Ÿ      | âŒï¼ˆè¦é’±ï¼‰          |
| ä¸­æ–‡ / å¤šè¯­è¨€ + å…è´¹ | `HuggingFaceEmbeddingModel`ï¼ˆåŠ è½½ BGEï¼‰ | å…è´¹ã€æœ¬åœ°éƒ¨ç½²ã€è¯­ä¹‰èƒ½åŠ›å¼º   | âœ…                  |
| ä¸­æ–‡ + Ollama        | `OllamaEmbeddingModel`                  | å’Œæœ¬åœ°æ¨¡å‹ç»“åˆï¼Œæ”¯æŒç®€åŒ–     | âœ…                  |
| å…¨å¹³å°æœ¬åœ°å¯ç”¨       | `LocalAiEmbeddingModel`                 | æ”¯æŒ OpenAI API å…¼å®¹æœ¬åœ°æ¨¡å‹ | âœ…                  |

```java
EmbeddingModel embeddingModel = HuggingFaceEmbeddingModel.builder()
    .modelName("BAAI/bge-small-en-v1.5") // æˆ–ä¸­æ–‡ bge-large-zh
    .build();
```

- ä¸­æ–‡å»ºè®®ç”¨ `bge-small-zh-v1.5` / `m3e-base` / `text2vec`
- è‹±æ–‡å»ºè®®ç”¨ `gte-small` / `e5-small`

------

## ğŸ“¦ 3. å‘é‡æ•°æ®åº“ï¼ˆVectorStoreï¼‰â€”â€”â€œæ€ä¹ˆå­˜å‚¨ + æ£€ç´¢è¯­ä¹‰å‘é‡ï¼Ÿâ€

LangChain4j æ”¯æŒä¸»æµå‘é‡åº“é€‚é…å™¨ï¼š

| å‘é‡åº“        | å®ç°ç±»                         | æ˜¯å¦æ¨è                        | ä¼˜åŠ¿                    |
| ------------- | ------------------------------ | ------------------------------- | ----------------------- |
| Redis         | `RedisVectorStore`             | âœ… å¼ºæ¨ï¼ˆè½»é‡éƒ¨ç½² + å¤šæ¨¡æ€æ”¯æŒï¼‰ | ç®€å•ã€å¿«é€Ÿã€æœ¬åœ°å¯ç”¨    |
| Faiss         | `FaissVectorStore`ï¼ˆé€šè¿‡ JNIï¼‰ | âœ… å­¦æœ¯ç•Œæ ‡å‡†                    | æœç´¢å¿«ï¼Œä½†éƒ¨ç½²ç•¥å¤æ‚    |
| Milvus        | `MilvusVectorStore`            | âœ… è¶…å¤§è§„æ¨¡æ•°æ®æ¨è              | åˆ†å¸ƒå¼ã€é«˜å¹¶å‘          |
| Chroma        | `ChromaVectorStore`            | âš ï¸ ä¸æ¨èç”Ÿäº§                    | ä»…æµ‹è¯•ç”¨ï¼Œä¸ç¨³å®š        |
| Elasticsearch | `ElasticVectorStore`           | âœ… å¦‚æœä½ å·²æœ‰ ELK æ ˆ             | å†…åµŒæ£€ç´¢ï¼Œå‘é‡ + ç»“æ„åŒ– |

```java
VectorStore vectorStore = RedisVectorStore.builder()
    .embeddingModel(embeddingModel)
    .host("localhost")
    .port(6379)
    .build();
```

------

## ğŸš€ æ€»ç»“ï¼šæ¨èä¸€å¥—ç»„åˆï¼ˆå…è´¹ + ä¸­æ–‡é€‚é…ï¼‰

| ç»„ä»¶     | æ¨è                                                 |
| -------- | ---------------------------------------------------- |
| åˆ†è¯å™¨   | `RecursiveTextSplitter`ï¼ˆchunkSize 500ï¼Œoverlap 50ï¼‰ |
| åµŒå…¥æ¨¡å‹ | `HuggingFaceEmbeddingModel` + `bge-small-zh-v1.5`    |
| å‘é‡åº“   | `RedisVectorStore`ï¼ˆå¥½éƒ¨ç½²ï¼ŒLangChain4j æ”¯æŒå¥½ï¼‰     |

## ğŸŒˆ Bonusï¼šå®Œæ•´æµç¨‹ä»£ç ç¤ºæ„

```java
EmbeddingModel embeddingModel = HuggingFaceEmbeddingModel.builder()
    .modelName("bge-small-zh-v1.5")
    .build();

TextSplitter splitter = RecursiveTextSplitter.builder()
    .chunkSize(500)
    .chunkOverlap(50)
    .build();

VectorStore vectorStore = RedisVectorStore.builder()
    .embeddingModel(embeddingModel)
    .host("localhost")
    .port(6379)
    .build();

List<Document> docs = splitter.split("æ“ä½œç³»ç»Ÿæ˜¯è®¡ç®—æœºçš„æ ¸å¿ƒ...");
vectorStore.add(docs);
List<Document> result = vectorStore.similar("ä»€ä¹ˆæ˜¯æ“ä½œç³»ç»Ÿ", 3);
```







